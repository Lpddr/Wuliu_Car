/**
 ******************************************************************************
 * @file    app_param.h
 * @author  lingxing
 * @brief   全局参数与常量定义
 * @note    统一使用 mm (毫米) 和 mm/s 作为单位。
 *          所有旋转相关的目标均基于“发车初始零度”为基推算。
 ******************************************************************************
 */

#ifndef __APP_PARAM_H
#define __APP_PARAM_H

#include <rtthread.h>

/* ========================================================================== */
/*                          1. 基础物理参数 (Basic)                             */
/* ========================================================================== */

/** [配置] 每毫米对应的脉冲数
 *  实际走多了 减小此值。 */
#define PULSE_PER_MM 15.6f

/* ========================================================================== */
/*                          2. 运动控制规划 (app_move)                         */
/* ========================================================================== */

/* --- T型加减速规划 (T-Curve) --- */
/** T型加速斜率 (mm/s^2)
 *  作用：数值越大起步越猛 */
#define MOVE_ACCEL_VAL 200.0f

/* --- 运动控制映射 --- */
/** 驱动器速度比例系数
 *  由于电机驱动接收 -10000 到 10000 的频率单位，此系数将 mm/s 转换为频率。
 * 
 *  感知不明显 调大 */
#define MOVE_SPEED_SCALE 286.0f

/* --- 直线行走逻辑 (航向锁 PID) --- */
#define PID_KP_STRAIGHT 1.95f
#define PID_KI_STRAIGHT 0.01f
#define PID_KD_STRAIGHT 0.54f

/* --- 旋转转弯逻辑 (位置环 PID) --- */
#define PID_KP_TURN 3.96f
#define PID_KI_TURN 0.02f
#define PID_KD_TURN 1.26f
#define TURN_ERROR_THRESHOLD 1.5f /* 容差角度 (度) */

/* ========================================================================== */
/*                          3. 舵机预设角度 (app_task)                         */
/* ========================================================================== */

#define CLAW_OPEN 10  /* 爪子：张开角度 (由 30 改为 10) */
#define CLAW_CLOSE 60 /* 爪子：闭合角度 */

#define PLATE_RED 17    /* 转盘：位置1 */
#define PLATE_GREEN 105 /* 转盘：位置2 */
#define PLATE_BLUE 200  /* 转盘：位置3 */

#endif /* __APP_PARAM_H */
